<!DOCTYPE html><html><head><meta charset="utf-8"/><link rel="icon" href="/core/favicon.ico"/><title>@magic/core concepts</title><meta name="description" content="@magic/core conceptual information."/><link rel="stylesheet" href="/core/magic.css"/></head><body><div id="magic"><div class="wrapper"><header class="main"><a href="/core/"><img class="logo" src="/core/logo.png" role="presentation" alt=""/><span class="logo-text">@magic</span></a><nav class="Menu"><ul><li class="active"><a href="/core/concepts/">concepts</a></li><li><a href="/core/files/">files &amp; directories</a></li><li><a href="/core/modules/">modules</a></li><li><a href="/core/themes/">themes</a></li><li><a href="/core/dependencies/">dependencies</a></li></ul></nav></header><div class="page"><h1>@magic/core concepts</h1><p>magic concepts. These are the building blocks of every module in a magic app</p><div><div><h2>modules</h2><p>modules are the main building block of magic.</p><p>modules can include state, actions, style and multiple components (which we call Views).</p><p>View names have to start with an uppercased character. Every module can export multiple components that share state, actions and styles.</p></div><div><h2>state</h2><div><p>state is a javascript object.</p><p>state can be mutated by actions.</p><p>every rendering step, the state determines the output of the view</p><h3>example state:</h3><div class="Pre light"><div class="menu"><button>dark</button><button>copy</button></div><pre><code class="line"><code class="line comment">// state variables can be anything you can JSON.stringify()</code></code><code class="line"><span class="state">state</span>: {</code><code class="line">  <span class="colon">variable</span>: <span class="boolean">true</span>,</code><code class="line">  <span class="colon">args</span>: <span class="string">&#39;none&#39;</span>,</code><code class="line">}</code></pre></div></div></div><div><h2>actions</h2><p>actions are an object containing functions</p><p>those functions get the state and actions and may return a new partial state.</p><p>alternatively, you can call any action any other action.</p><h3>example actions</h3><div class="Pre light"><div class="menu"><button>dark</button><button>copy</button></div><pre><code class="line"><code class="line comment">// actions are an object containing functions.</code></code><code class="line"><code class="line comment">// if an action returns an object, this object gets merged into the state</code></code><code class="line"><span class="actions">actions</span>: {</code><code class="line">  <span class="colon">changeVariable</span>: args =&gt; <span class="state">state</span> =&gt; ({</code><code class="line">    <span class="colon">variable</span>: !<span class="state">state</span>.<span class="property">variable</span>,</code><code class="line">    args,</code><code class="line">  }),</code><code class="line">  <span class="colon">callActionInAction</span>: () =&gt; <span class="keyword">async</span> (<span class="state">state</span>, <span class="actions">actions</span>) =&gt; {</code><code class="line"><code class="line comment">    // just await something inside an action to create an async action</code></code><code class="line">    <span class="keyword">await</span><span class="keyword"> </span><span class="keyword">new</span><span class="keyword"> </span><span class="builtin">Promise</span>(resolve =&gt; {</code><code class="line">      <span class="builtin">setTimeout</span>(resolve, 200)</code><code class="line">    })</code><code class="line"></code><code class="line"><code class="line comment">    // actions can call other actions</code></code><code class="line">    <span class="actions">actions</span>.<span class="property">changeVariable</span>(<span class="state">state</span>.<span class="property">variable</span> ? <span class="string">&#39;arg passed to function&#39;</span> : <span class="string">&#39;&#39;</span>)</code><code class="line">  },</code><code class="line">}</code></pre></div></div><div><h2>views</h2><p>views render the state to html</p><p>whenever an action triggers a statechange, this statechange then triggers a view change.</p><h3>example view</h3><div class="Pre light"><div class="menu"><button>dark</button><button>copy</button></div><pre><code class="line"><span class="colon">View</span>: (<span class="state">state</span>, <span class="actions">actions</span>) =&gt; (</code><code class="line">  div({ <span class="colon">onclick</span>: <span class="actions">actions</span>.<span class="property">callActionInAction</span> }, <span class="state">state</span>.<span class="property">variable</span>)</code><code class="line">)</code></pre></div></div><div><h2>styles</h2><p>every module can have a style object attached to it.</p><p>magic will automagically merge all styles into one global css file.</p><p>in the future, it will also remove unused styles for you.</p><p>style merge order from lowest to highest:</p><p>module.style &lt; page.style &lt; app.style &lt; theme.style</p><h3>example styles</h3><div class="Pre light"><div class="menu"><button>dark</button><button>copy</button></div><pre><code class="line"><span class="colon">style</span>: {</code><code class="line">  <span class="string">&#39;.className&#39;</span>: {</code><code class="line">    <span class="colon">color</span>: <span class="string">&#39;green&#39;</span>,</code><code class="line"></code><code class="line"><code class="line comment">    // expands to .className:hover because of the &amp;</code></code><code class="line">    <span class="string">&#39;&amp;:hover&#39;</span>: {</code><code class="line">      <span class="colon">color</span>: <span class="string">&#39;orange&#39;</span>,</code><code class="line">    },</code><code class="line"></code><code class="line"><code class="line comment">    // expands to .className .childClass</code></code><code class="line">    <span class="string">&#39;.childClass&#39;</span>: {</code><code class="line">      <span class="colon">color</span>: <span class="string">&#39;blue&#39;</span>,</code><code class="line">    },</code><code class="line">  },</code><code class="line"><code class="line comment">  // css ids</code></code><code class="line">  <span class="string">&#39;#id&#39;</span>: {</code><code class="line">    <span class="colon">color</span>: <span class="string">&#39;yellow&#39;</span>,</code><code class="line">  },</code><code class="line"><code class="line comment">  // default html tag styles</code></code><code class="line">  <span class="colon">div</span>: {</code><code class="line">    <span class="colon">color</span>: <span class="string">&#39;black&#39;</span>,</code><code class="line">  },</code><code class="line">}</code></pre></div></div><div><h2>global</h2><p>every module can set a global object, containing state and action properties.</p><p>every key in the mod.global object that is set to true gets merged into the main app state/actions.</p><h3>example globals</h3><div class="Pre light"><div class="menu"><button>dark</button><button>copy</button></div><pre><code class="line"><span class="colon">global</span>: {</code><code class="line">  <span class="state">state</span>: {</code><code class="line">    <span class="colon">variable</span>: <span class="boolean">true</span>,</code><code class="line">    <span class="colon">args</span>: <span class="boolean">true</span>,</code><code class="line">  },</code><code class="line">  <span class="actions">actions</span>: {</code><code class="line">    <span class="colon">callActionInAction</span>: <span class="boolean">true</span>,</code><code class="line">    <span class="colon">changeVariable</span>: <span class="boolean">true</span>,</code><code class="line">  },</code><code class="line">}</code></pre></div></div><div><h2>Full example</h2><p>If we assemble those pieces, we get the following:</p><div class="Pre light"><div class="menu"><button>dark</button><button>copy</button></div><pre><code class="line"><span class="keyword">const</span><span class="keyword"> </span>exampleModule = {</code><code class="line">    </code><code class="line"><code class="line comment">  // state variables can be anything you can JSON.stringify()</code></code><code class="line">  <span class="state">state</span>: {</code><code class="line">    <span class="colon">variable</span>: <span class="boolean">true</span>,</code><code class="line">    <span class="colon">args</span>: <span class="string">&#39;none&#39;</span>,</code><code class="line">  },</code><code class="line">    </code><code class="line"><code class="line comment">  // actions are an object containing functions.</code></code><code class="line"><code class="line comment">  // if an action returns an object, this object gets merged into the state</code></code><code class="line">  <span class="actions">actions</span>: {</code><code class="line">    <span class="colon">changeVariable</span>: args =&gt; <span class="state">state</span> =&gt; ({</code><code class="line">      <span class="colon">variable</span>: !<span class="state">state</span>.<span class="property">variable</span>,</code><code class="line">      args,</code><code class="line">    }),</code><code class="line">    <span class="colon">callActionInAction</span>: () =&gt; <span class="keyword">async</span> (<span class="state">state</span>, <span class="actions">actions</span>) =&gt; {</code><code class="line"><code class="line comment">      // just await something inside an action to create an async action</code></code><code class="line">      <span class="keyword">await</span><span class="keyword"> </span><span class="keyword">new</span><span class="keyword"> </span><span class="builtin">Promise</span>(resolve =&gt; {</code><code class="line">        <span class="builtin">setTimeout</span>(resolve, 200)</code><code class="line">      })</code><code class="line">  </code><code class="line"><code class="line comment">      // actions can call other actions</code></code><code class="line">      <span class="actions">actions</span>.<span class="property">changeVariable</span>(<span class="state">state</span>.<span class="property">variable</span> ? <span class="string">&#39;arg passed to function&#39;</span> : <span class="string">&#39;&#39;</span>)</code><code class="line">    },</code><code class="line">  },</code><code class="line">    </code><code class="line">  <span class="colon">style</span>: {</code><code class="line">    <span class="string">&#39;.className&#39;</span>: {</code><code class="line">      <span class="colon">color</span>: <span class="string">&#39;green&#39;</span>,</code><code class="line">  </code><code class="line"><code class="line comment">      // expands to .className:hover because of the &amp;</code></code><code class="line">      <span class="string">&#39;&amp;:hover&#39;</span>: {</code><code class="line">        <span class="colon">color</span>: <span class="string">&#39;orange&#39;</span>,</code><code class="line">      },</code><code class="line">  </code><code class="line"><code class="line comment">      // expands to .className .childClass</code></code><code class="line">      <span class="string">&#39;.childClass&#39;</span>: {</code><code class="line">        <span class="colon">color</span>: <span class="string">&#39;blue&#39;</span>,</code><code class="line">      },</code><code class="line">    },</code><code class="line"><code class="line comment">    // css ids</code></code><code class="line">    <span class="string">&#39;#id&#39;</span>: {</code><code class="line">      <span class="colon">color</span>: <span class="string">&#39;yellow&#39;</span>,</code><code class="line">    },</code><code class="line"><code class="line comment">    // default html tag styles</code></code><code class="line">    <span class="colon">div</span>: {</code><code class="line">      <span class="colon">color</span>: <span class="string">&#39;black&#39;</span>,</code><code class="line">    },</code><code class="line">  },</code><code class="line">    </code><code class="line">  <span class="colon">View</span>: (<span class="state">state</span>, <span class="actions">actions</span>) =&gt; (</code><code class="line">    div({ <span class="colon">onclick</span>: <span class="actions">actions</span>.<span class="property">callActionInAction</span> }, <span class="state">state</span>.<span class="property">variable</span>)</code><code class="line">  ),</code><code class="line">    </code><code class="line">  <span class="colon">global</span>: {</code><code class="line">    <span class="state">state</span>: {</code><code class="line">      <span class="colon">variable</span>: <span class="boolean">true</span>,</code><code class="line">      <span class="colon">args</span>: <span class="boolean">true</span>,</code><code class="line">    },</code><code class="line">    <span class="actions">actions</span>: {</code><code class="line">      <span class="colon">callActionInAction</span>: <span class="boolean">true</span>,</code><code class="line">      <span class="colon">changeVariable</span>: <span class="boolean">true</span>,</code><code class="line">    },</code><code class="line">  },</code><code class="line">}</code></pre></div></div></div></div><footer class="main"><div class="wrapper">made with a few bits of <a href="https://github.com/magic/core" rel="noopener" target="_blank">magic</a></div></footer></div></div><script type="text/javascript" src="/core/magic.js"></script></body></html>