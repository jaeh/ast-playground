<!DOCTYPE html><html><head><meta charset="utf-8"/><link rel="icon" href="/core/favicon.ico"/><title>@magic/core files</title><link rel="stylesheet" href="/core/magic.css"/></head><body><div id="magic"><div class="wrapper"><header class="main"><img class="logo" src="/core/logo.png" height="100" width="200" role="presentation"/><nav class="Menu"><ul><li theme="light"></li><li><a href="/core/">home</a></li><li theme="light"></li><li><a href="/core/deep/">deep</a></li><li theme="light"></li><li class="active"><a href="/core/docs/">docs</a></li></ul></nav></header><div class="page"><header class="sub"><h3>Contents:</h3><nav class="Menu"><ul><li><a href="/core/docs/concepts/">concepts</a></li><li class="active"><a href="/core/docs/files/">files &amp; directories</a></li><li><a href="/core/docs/modules/">modules</a></li><li><a href="/core/docs/themes/">themes</a></li><li><a href="/core/docs/dependencies/">dependencies</a></li></ul></nav></header><h1>@magic/core files</h1><p>There are multiple magic files and directories.</p><ul><li>/pages - directory maps to urls in your app</li><li>/static - static files</li><li>/assets - custom components, @magic-modules get imported here</li><li>/themes - theme directory, @magic-themes get imported here</li><li>/app.js - gets merged into the app, can set state, actions, style here</li><li>/config.js - custom config for your app</li><li>/assets/Menu.js - custom Menu for your app</li></ul><div id="pages"><h2>/pages</h2><p>the pages dir contains the pages of your webapp.</p><p>each page has it&#39;s own state and actions, but also inherits the global state and actions from the app and it&#39;s dependencies</p><h3>example page:</h3><pre class="Pre light"><div class="menu"><button>dark</button><button>light</button><button>copy</button></div><code class="line"><span class="keyword">module</span>.<span class="keyword">exports</span> = {</code><code class="line">  <span class="colon">state</span>: {</code><code class="line">    <span class="colon">variable</span>: <span class="string">&#39;test&#39;</span>,</code><code class="line">  },</code><code class="line">  <span class="colon">actions</span>: {</code><code class="line">    <span class="colon">changeVar</span>: () =&gt; ({ <span class="colon">variable</span>: <span class="string">&#39;changed&#39;</span> }),</code><code class="line">  },</code><code class="line">  <span class="colon">style</span>: {</code><code class="line">    <span class="string">&#39;.cl&#39;</span>: {</code><code class="line">      <span class="colon">color</span>: <span class="string">&#39;green&#39;</span>,</code><code class="line">    },</code><code class="line">  },</code><code class="line">  <span class="colon">Body</span>: <span class="state">state</span> =&gt; div({ <span class="colon">class</span>: <span class="string">&#39;cl&#39;</span> }, [<span class="string">&#39;this is the page content.&#39;</span>, <span class="state">state</span>.<span class="property">variable</span>]),</code><code class="line">}</code></pre></div><div id="static"><h2>/static</h2><p>the static dir contains all of your static assets.</p><p>every file in this directory gets copied to the app</p><p>image and svg files get minified using imagemin</p><p>text and binary files get compressed using zopfli</p></div><div id="assets"><h2>/assets</h2><p>the assets dir contains custom components of your app.</p><p>you can additionally import @magic-modules here</p><h3>example /assets/index.js</h3><pre class="Pre light"><div class="menu"><button>dark</button><button>light</button><button>copy</button></div><code class="line"><span class="keyword">module</span>.<span class="keyword">exports</span> = {</code><code class="line">  <span class="colon">Custom</span>: () =&gt; div(<span class="string">&#39;custom component&#39;</span>),</code><code class="line">  <span class="colon">Pre</span>: <span class="keyword">require</span>(<span class="string">&#39;@magic-modules/pre),&#39;</span></code><code class="line">}</code></pre></div><div id="themes"><h2>/themes</h2><p>the themes directory contains... themes.</p><p>at the moment this is file based, which means you have to manually import themes there.</p><p>TODO: handle themes as we handle assets. maybe move them into assets.</p><h3>example /themes/blue/index.js</h3><pre class="Pre light"><div class="menu"><button>dark</button><button>light</button><button>copy</button></div><code class="line"><span class="keyword">module</span>.<span class="keyword">exports</span> = {</code><code class="line">  <span class="string">&#39;body&#39;</span>: {</code><code class="line">    <span class="colon">color</span>: <span class="string">&#39;blue&#39;</span>,</code><code class="line">  },</code><code class="line">}</code></pre></div><div id="appinfo"><h2>/app.js</h2><p>the /app.js file allows you to set global state, actions, and styles</p><h3>example /app.js</h3><pre class="Pre light"><div class="menu"><button>dark</button><button>light</button><button>copy</button></div><code class="line"><span class="keyword">module</span>.<span class="keyword">exports</span> = {</code><code class="line">  <span class="colon">state</span>: {</code><code class="line">    <span class="colon">globalStateVar</span>: <span class="string">&#39;globally available&#39;</span>,</code><code class="line">  },</code><code class="line">  <span class="colon">actions</span>: {</code><code class="line">    <span class="colon">globalAction</span>: () =&gt; ({ <span class="colon">globalStateVar</span>: <span class="string">&#39;overwritten.&#39;</span> }),</code><code class="line">  },</code><code class="line">  <span class="colon">style</span>: {</code><code class="line">    <span class="string">&#39;body&#39;</span>: {</code><code class="line">      <span class="colon">color</span>: <span class="string">&#39;green&#39;</span>,</code><code class="line">    },</code><code class="line">  },</code><code class="line">}</code></pre></div><div id="config"><h2>/config.js</h2><p>the /config.js file allows you to set the theme, root and web_root of your app</p><h3>example /config.js</h3><pre class="Pre light"><div class="menu"><button>dark</button><button>light</button><button>copy</button></div><code class="line"><span class="keyword">module</span>.<span class="keyword">exports</span> = {</code><code class="line">  <span class="colon">ROOT</span>: <span class="string">&#39;example&#39;</span>,</code><code class="line">  <span class="colon">THEME</span>: <span class="string">&#39;blue&#39;</span>,</code><code class="line">  <span class="colon">WEB_ROOT</span>: <span class="string">&#39;/core/&#39;</span>,</code><code class="line"></code><code class="line"><code class="line comment">  // this option adds the</code></code><code class="line"><code class="line comment">  // &#39;X-Clacks-Overhead&#39;, &#39;GNU Terry Pratchet&#39;</code></code><code class="line"><code class="line comment">  // http header</code></code><code class="line"><code class="line comment">  // see http://www.gnuterrypratchett.com/</code></code><code class="line">  <span class="colon">FOR_DEATH_CAN_NOT_HAVE_HIM</span>: <span class="boolean">true</span>,</code><code class="line">}</code></pre></div><div id="menu"><h2>/assets/Menu.js</h2><p>the /assets/Menu.js file allows you to replace the default Menu component</p><h3>example /assets/Menu.js</h3><p>which changes nothing</p><pre class="Pre light"><div class="menu"><button>dark</button><button>light</button><button>copy</button></div><code class="line"><span class="keyword">module</span>.<span class="keyword">exports</span> = {</code><code class="line">  <span class="colon">View</span>: ({ name = <span class="string">&#39;menu&#39;</span>, between = <span class="boolean">false</span>, pre = <span class="boolean">false</span>, post = <span class="boolean">false</span> }) =&gt; (<span class="state">state</span>, <span class="actions">actions</span>) =&gt; {</code><code class="line">    <span class="keyword">if</span> (!<span class="state">state</span>[name] || !<span class="state">state</span>[name].length) {</code><code class="line">      <span class="keyword">return</span></code><code class="line">    }</code><code class="line"></code><code class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span><span class="keyword"> </span>window !== <span class="string">&#39;undefined&#39;</span>) {</code><code class="line">      <span class="object">window</span>.<span class="property">addEventListener</span>(<span class="string">&#39;popstate&#39;</span>, <span class="actions">actions</span>.<span class="keyword">go</span>)</code><code class="line">    }</code><code class="line"></code><code class="line">    <span class="keyword">return</span><span class="keyword"> </span>nav({ <span class="colon">class</span>: <span class="string">&#39;Menu&#39;</span> }, [</code><code class="line">      <span class="keyword">ul</span>(</code><code class="line">        <span class="state">state</span>[name].map((item, <span class="keyword">i</span>) =&gt; {</code><code class="line">          <span class="keyword">const</span><span class="keyword"> </span>props = {}</code><code class="line">          <span class="keyword">const</span><span class="keyword"> </span>isEqual = <span class="object">item</span>.<span class="keyword">to</span> === <span class="state">state</span>.<span class="property">url</span></code><code class="line">          <span class="keyword">const</span><span class="keyword"> </span>isActive = <span class="object">item</span>.<span class="keyword">to</span> !== <span class="string">&#39;/&#39;</span> &amp;&amp; <span class="state">state</span>.<span class="property">url</span>.<span class="property">startsWith</span>(<span class="object">item</span>.<span class="keyword">to</span>)</code><code class="line">          <span class="keyword">if</span> (isEqual || isActive) {</code><code class="line">            <span class="object">props</span>.<span class="keyword">class</span> = <span class="string">&#39;active&#39;</span></code><code class="line">          } <span class="keyword">else</span> {</code><code class="line">            <span class="object">props</span>.<span class="keyword">class</span> = <span class="keyword">null</span></code><code class="line">          }</code><code class="line"></code><code class="line">          <span class="keyword">return</span> [</code><code class="line">            pre &amp;&amp; <span class="keyword">li</span>(pre),</code><code class="line">            <span class="keyword">li</span>(props, Link(item)),</code><code class="line">            between &amp;&amp; <span class="keyword">i</span> &lt; <span class="state">state</span>[name].length - <span class="builtin">1</span> ? <span class="keyword">li</span>(<span class="string">&#39; - &#39;</span>) : <span class="string">&#39;&#39;</span>,</code><code class="line">            post &amp;&amp; <span class="keyword">li</span>(post),</code><code class="line">          ]</code><code class="line">        }),</code><code class="line">      ),</code><code class="line">    ])</code><code class="line">  },</code><code class="line">}</code></pre></div></div><footer class="main"><div class="wrapper">made with a few bits of <a href="" rel="noopener" target="_blank">magic</a></div></footer></div></div><script type="text/javascript" src="/core/magic.js"></script></body></html>