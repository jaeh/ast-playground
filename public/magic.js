function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function h(name,attributes){var rest=[];var children=[];var length=arguments.length;while(length-->2){rest.push(arguments[length])}while(rest.length){var node=rest.pop();if(node&&node.pop){for(length=node.length;length--;){rest.push(node[length])}}else if(node!=null&&node!==true&&node!==false){children.push(node)}}return typeof name==="function"?name(attributes||{},children):{nodeName:name,attributes:attributes||{},children:children,key:attributes&&attributes.key}}function app(state,actions,view,container){var map=[].map;var rootElement=container&&container.children[0]||null;var oldNode=rootElement&&recycleElement(rootElement);var lifecycle=[];var skipRender;var isRecycling=true;var globalState=clone(state);var wiredActions=wireStateToActions([],globalState,clone(actions));scheduleRender();return wiredActions;function recycleElement(element){return{nodeName:element.nodeName.toLowerCase(),attributes:{},children:map.call(element.childNodes,function(element){return element.nodeType===3?element.nodeValue:recycleElement(element)})}}function resolveNode(node){return typeof node==="function"?resolveNode(node(globalState,wiredActions)):node!=null?node:""}function render(){skipRender=!skipRender;var node=resolveNode(view);if(container&&!skipRender){rootElement=patch(container,rootElement,oldNode,oldNode=node)}isRecycling=false;while(lifecycle.length){lifecycle.pop()()}}function scheduleRender(){if(!skipRender){skipRender=true;setTimeout(render)}}function clone(target,source){var out={};for(var i in target){out[i]=target[i]}for(var i in source){out[i]=source[i]}return out}function setPartialState(path,value,source){var target={};if(path.length){target[path[0]]=path.length>1?setPartialState(path.slice(1),value,source[path[0]]):value;return clone(source,target)}return value}function getPartialState(path,source){var i=0;while(i<path.length){source=source[path[i++]]}return source}function wireStateToActions(path,state,actions){for(var key in actions){typeof actions[key]==="function"?function(key,action){actions[key]=function(data){var result=action(data);if(typeof result==="function"){result=result(getPartialState(path,globalState),actions)}if(result&&result!==(state=getPartialState(path,globalState))&&!result.then){scheduleRender(globalState=setPartialState(path,clone(state,result),globalState))}return result}}(key,actions[key]):wireStateToActions(path.concat(key),state[key]=clone(state[key]),actions[key]=clone(actions[key]))}return actions}function getKey(node){return node?node.key:null}function eventListener(event){return event.currentTarget.events[event.type](event)}function updateAttribute(element,name,value,oldValue,isSvg){if(name==="key"){}else if(name==="style"){if(typeof value==="string"){element.style.cssText=value}else{if(typeof oldValue==="string")oldValue=element.style.cssText="";for(var i in clone(oldValue,value)){var style=value==null||value[i]==null?"":value[i];if(i[0]==="-"){element.style.setProperty(i,style)}else{element.style[i]=style}}}}else{if(name[0]==="o"&&name[1]==="n"){name=name.slice(2);if(element.events){if(!oldValue)oldValue=element.events[name]}else{element.events={}}element.events[name]=value;if(value){if(!oldValue){element.addEventListener(name,eventListener)}}else{element.removeEventListener(name,eventListener)}}else if(name in element&&name!=="list"&&name!=="type"&&name!=="draggable"&&name!=="spellcheck"&&name!=="translate"&&!isSvg){element[name]=value==null?"":value}else if(value!=null&&value!==false){element.setAttribute(name,value)}if(value==null||value===false){element.removeAttribute(name)}}}function createElement(node,isSvg){var element=typeof node==="string"||typeof node==="number"?document.createTextNode(node):(isSvg=isSvg||node.nodeName==="svg")?document.createElementNS("http://www.w3.org/2000/svg",node.nodeName):document.createElement(node.nodeName);var attributes=node.attributes;if(attributes){if(attributes.oncreate){lifecycle.push(function(){attributes.oncreate(element)})}for(var i=0;i<node.children.length;i++){element.appendChild(createElement(node.children[i]=resolveNode(node.children[i]),isSvg))}for(var name in attributes){updateAttribute(element,name,attributes[name],null,isSvg)}}return element}function updateElement(element,oldAttributes,attributes,isSvg){for(var name in clone(oldAttributes,attributes)){if(attributes[name]!==(name==="value"||name==="checked"?element[name]:oldAttributes[name])){updateAttribute(element,name,attributes[name],oldAttributes[name],isSvg)}}var cb=isRecycling?attributes.oncreate:attributes.onupdate;if(cb){lifecycle.push(function(){cb(element,oldAttributes)})}}function removeChildren(element,node){var attributes=node.attributes;if(attributes){for(var i=0;i<node.children.length;i++){removeChildren(element.childNodes[i],node.children[i])}if(attributes.ondestroy){attributes.ondestroy(element)}}return element}function removeElement(parent,element,node){function done(){parent.removeChild(removeChildren(element,node))}var cb=node.attributes&&node.attributes.onremove;if(cb){cb(element,done)}else{done()}}function patch(parent,element,oldNode,node,isSvg){if(node===oldNode){}else if(oldNode==null||oldNode.nodeName!==node.nodeName){var newElement=createElement(node,isSvg);parent.insertBefore(newElement,element);if(oldNode!=null){removeElement(parent,element,oldNode)}element=newElement}else if(oldNode.nodeName==null){element.nodeValue=node}else{updateElement(element,oldNode.attributes,node.attributes,isSvg=isSvg||node.nodeName==="svg");var oldKeyed={};var newKeyed={};var oldElements=[];var oldChildren=oldNode.children;var children=node.children;for(var i=0;i<oldChildren.length;i++){oldElements[i]=element.childNodes[i];var oldKey=getKey(oldChildren[i]);if(oldKey!=null){oldKeyed[oldKey]=[oldElements[i],oldChildren[i]]}}var i=0;var k=0;while(k<children.length){var oldKey=getKey(oldChildren[i]);var newKey=getKey(children[k]=resolveNode(children[k]));if(newKeyed[oldKey]){i++;continue}if(newKey!=null&&newKey===getKey(oldChildren[i+1])){if(oldKey==null){removeElement(element,oldElements[i],oldChildren[i])}i++;continue}if(newKey==null||isRecycling){if(oldKey==null){patch(element,oldElements[i],oldChildren[i],children[k],isSvg);k++}i++}else{var keyedNode=oldKeyed[newKey]||[];if(oldKey===newKey){patch(element,keyedNode[0],keyedNode[1],children[k],isSvg);i++}else if(keyedNode[0]){patch(element,element.insertBefore(keyedNode[0],oldElements[i]),keyedNode[1],children[k],isSvg)}else{patch(element,oldElements[i],null,children[k],isSvg)}newKeyed[newKey]=children[k];k++}}while(i<oldChildren.length){if(getKey(oldChildren[i])==null){removeElement(element,oldElements[i],oldChildren[i])}i++}for(var i in oldKeyed){if(!newKeyed[i]){removeElement(element,oldKeyed[i][0],oldKeyed[i][1])}}}return element}}var C=function C(n){return function(){var a=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var c=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!c){if(typeof a==="string"||typeof a==="number"||Array.isArray(a)){c=a;a={}}}return h(n,a,c)}};var Menu={View:function View(_ref){var _ref$name=_ref.name,name=_ref$name===void 0?"menu":_ref$name;return function(state,actions){if(!state[name]||!state[name].length){return}if(typeof window!=="undefined"){window.addEventListener("popstate",actions.go)}return nav({class:"Menu"},[ul(state[name].map(function(item){return[li({class:state.url===item.to?"active":""},[a({href:item.to,onclick:actions.go},item.text)])]}))])}}};var a=C("a");var li=C("li");var nav=C("nav");var ul=C("ul");var div=C("div");var header=C("header");var img=C("img");var u=C("u");var h1=C("h1");var Count={View:function View(state,actions){return div([div("count: ".concat(state.count)),button({onclick:function onclick(){return actions.count(1)}},"+1"),button({onclick:function onclick(){return actions.count(10)}},"+10"),button({onclick:function onclick(){return actions.count(-1)}},"-1"),button({onclick:function onclick(){return actions.count(-10)}},"-10")])}};var button=C("button");var h3=C("h3");var p=C("p");var Wrapper={View:function View(state,actions){return div({class:"Wrapper".concat(state.wrapperStateVar?" Test":"")},[Inside(state,actions),button({onclick:actions.wrapperAction},"click me")])}};var i=C("i");var Inside=function Inside(state){return i(state.app.title)};var pages={"/ast-playground/deep/":function astPlaygroundDeep(state,actions){return[h1(state.title),div("page content"),Count.View(state,actions)]},"/ast-playground/docs/":function astPlaygroundDocs(state,actions){return[h1(state.title),h3("Contents:"),Menu.View({name:"docMenu"})(state,actions),div([p("Welcome to the magic docs.")])]},"/ast-playground/":function astPlayground(state,actions){return[h1(state.title),div([p("index page content"),p("can stretch multiple lines"),ul([li("and contain"),li("lists of content")])]),Count.View(state,actions),Wrapper.View(state,actions)]},"/ast-playground/404/":div("404 not found")};var state={"app":{"title":"Custom App Title","description":"Custom App Description"},"url":"/ast-playground/","menu":[{"to":"/ast-playground/","text":"home"},{"to":"/ast-playground/deep/","text":"deep"}],"logo":"/ast-playground/logo.png","pages":{"/ast-playground/deep/":{"count":0,"title":"h1 deep/index","htmlTitle":"testing the html title tag","url":"/ast-playground/deep/"},"/ast-playground/docs/":{"title":"@magic/core docs","description":"@magic/core documentation directory.","docMenu":[{"to":"/ast-playground/docs/test","text":"test"}]},"/ast-playground/":{"count":0,"wrapperStateVar":false,"title":"h1 indexpage","description":"custom description"}},"count":0};state.url=window.location.pathname;var actions={"go":function go(e){return function(state){e.preventDefault();var url=state.url;if(e.target&&e.target.href){url=e.target.href.replace(window.location.origin,"");if(url!==state.url){window.history&&window.history.pushState({urlPath:url},"",url)}}else{if(e.state){url=e.state.urlPath}else{url="/ast-playground/"}}return{url:url,prev:state.url}}},"pages":{"/ast-playground/deep/":{"count":function count(mod){return function(state){return{count:state.count+mod}}},"deepAction":function deepAction(state){return{test:!state.test}}},"/ast-playground/docs/":{"go":function go(e){return function(state){e.preventDefault();var url=state.url;if(e.target&&e.target.href){url=e.target.href.replace(window.location.origin,"");if(url!==state.url){window.history&&window.history.pushState({urlPath:url},"",url)}}else{if(e.state){url=e.state.urlPath}else{url="/ast-playground/"}}return{url:url,prev:state.url}}}},"/ast-playground/":{"count":function count(mod){return function(state){return{count:state.count+mod}}},"wrapperAction":function wrapperAction(){return function(state){return{wrapperStateVar:!state.wrapperStateVar}}}}},"count":function count(mod){return function(state){return{count:state.count+mod}}}};function view(state,actions){var page=pages[state.url];state=_objectSpread({},state.pages[state.url],state);actions=_objectSpread({},actions.pages[state.url],actions);return div({class:"wrapper"},[header({class:"main"},[state.logo&&img({class:"logo",src:state.logo,role:"presentation"}),state.menu&&Menu.View(state,actions)]),page?page(state,actions):div("404 - not found")])}var d=document;var mD=d.getElementById("magic");if(!mD){mD=d.createElement("div");mD.id="magic";d.body.appendChild(mD)}app(state,actions,view,mD);